# Copyright 2009 Jonathan Dahan <jedahan@gmail.com>
# Distributed under the terms of the GNU General Public License v2

SCM_REPOSITORY="http://hg.subforge.org/${PN}/"

require scm-hg

SUMMARY="sublet management similar to rubygems"
DESCRIPTION="
sur consists of two parts which are designed to work with each other:

sur the manager script itself
surserver a webserver that manages a repository
"

HOMEPAGE="http://subforge.org/projects/sur"
DOWNLOADS=""

MYOPTIONS="server [[ description = [ build surserver ] ]]"
BUGS_TO="jedahan@gmail.com"
UPSTREAM_CHANGELOG="${HOMEPAGE}/repository/revisions/"
UPSTREAM_DOCUMENTATION="${HOMEPAGE}/wiki/"

LICENCES="GPL-2"
SLOT="0"
PLATFORMS="~amd64"

DEPENDENCIES="
    build+run:
        dev-ruby/archive-tar-minitar
        dev-lang/ruby[>=1.8]
        dev-ruby/curb[>=0.5.1.0]
        dev-ruby/rake[>=0.8]
        x11-wm/subtle[>=0.8]
        server? (
            dev-ruby/datamapper[>=0.9.11]
            dev-ruby/sinatra[>=0.9.4]
        )
"

src_compile() {
    edo rake destdir="${IMAGE}"
}

src_install() {
    edo rake destdir="${IMAGE}" install
    emagicdocs
}

